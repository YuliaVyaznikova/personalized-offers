Использую локальный датасет: C:\IMPORTANT\ACTIVITIES\sirius\repo\personalized-offers\experiments\models\catboost\sbolpro_merged_final.pqt
Размер исходных данных: (1051557, 505)
Колонки: ['feature_521', 'feature_967', 'feature_534', 'feature_968', 'feature_1160', 'feature_583', 'feature_519', 'feature_969', 'feature_1196', 'feature_510', 'feature_1157', 'feature_545', 'feature_530', 'feature_1096', 'feature_527', 'feature_1229', 'feature_506', 'feature_629', 'feature_1227', 'feature_639', 'feature_635', 'feature_971', 'feature_1239', 'feature_1225', 'feature_512', 'feature_533', 'feature_1222', 'feature_615', 'feature_587', 'feature_972', 'feature_1240', 'feature_591', 'feature_1216', 'feature_488', 'feature_1140', 'feature_1213', 'feature_1174', 'feature_562', 'feature_1192', 'feature_1199', 'feature_1193', 'feature_489', 'feature_508', 'feature_1182', 'feature_528', 'feature_549', 'feature_547', 'feature_476', 'feature_614', 'feature_973', 'feature_624', 'feature_975', 'feature_1233', 'feature_1221', 'feature_934', 'feature_1218', 'feature_1110', 'feature_571', 'feature_518', 'feature_1223', 'feature_503', 'feature_481', 'feature_597', 'feature_976', 'feature_507', 'feature_977', 'feature_494', 'feature_978', 'feature_1211', 'feature_500', 'feature_475', 'feature_468', 'feature_979', 'feature_980', 'feature_484', 'feature_474', 'feature_981', 'feature_982', 'feature_1212', 'feature_1170', 'feature_1201', 'feature_1202', 'feature_608', 'feature_557', 'feature_496', 'feature_1220', 'feature_522', 'feature_586', 'feature_470', 'feature_1158', 'feature_1190', 'feature_532', 'feature_590', 'feature_511', 'feature_983', 'feature_984', 'feature_1209', 'feature_1238', 'feature_1166', 'feature_1183', 'feature_1084', 'feature_1226', 'feature_654', 'feature_460', 'feature_588', 'feature_1159', 'feature_575', 'feature_1186', 'feature_581', 'feature_478', 'feature_1179', 'feature_1206', 'feature_535', 'feature_1097', 'feature_576', 'feature_479', 'feature_490', 'feature_1200', 'feature_1195', 'feature_1099', 'feature_1208', 'feature_482', 'feature_1191', 'feature_446', 'feature_1241', 'feature_1103', 'feature_430', 'feature_1189', 'feature_651', 'feature_471', 'feature_1175', 'feature_572', 'feature_1194', 'feature_1177', 'feature_541', 'feature_452', 'feature_1219', 'feature_1054', 'feature_1242', 'feature_1198', 'feature_1135', 'feature_630', 'feature_1154', 'feature_483', 'feature_457', 'feature_565', 'feature_493', 'feature_1184', 'feature_1231', 'feature_1187', 'feature_1030', 'feature_1237', 'feature_1171', 'feature_514', 'feature_1089', 'feature_1180', 'feature_467', 'feature_520', 'feature_516', 'feature_1107', 'feature_1247', 'feature_455', 'feature_1149', 'feature_1188', 'feature_1116', 'feature_598', 'feature_1145', 'feature_1147', 'feature_429', 'feature_1156', 'feature_574', 'feature_491', 'feature_454', 'feature_1148', 'feature_1098', 'feature_582', 'feature_1137', 'feature_502', 'feature_492', 'feature_498', 'feature_513', 'feature_607', 'feature_456', 'feature_1164', 'feature_497', 'feature_1142', 'feature_1061', 'feature_1105', 'feature_1150', 'feature_477', 'feature_1118', 'feature_1119', 'feature_1163', 'feature_486', 'feature_1094', 'feature_423', 'feature_1121', 'feature_526', 'feature_1114', 'feature_485', 'feature_501', 'feature_451', 'feature_1141', 'feature_1136', 'feature_444', 'feature_408', 'feature_569', 'feature_463', 'feature_1155', 'feature_1234', 'feature_487', 'feature_1117', 'feature_1144', 'feature_1139', 'feature_1051', 'feature_473', 'feature_420', 'feature_409', 'feature_1069', 'feature_1245', 'feature_465', 'feature_413', 'feature_1131', 'feature_1143', 'feature_1133', 'feature_480', 'feature_462', 'feature_1126', 'feature_1151', 'feature_1046', 'feature_517', 'feature_1125', 'feature_1070', 'feature_421', 'feature_405', 'feature_439', 'feature_1115', 'feature_1073', 'feature_435', 'feature_442', 'feature_458', 'feature_461', 'feature_1128', 'feature_464', 'feature_1132', 'feature_418', 'feature_1082', 'feature_449', 'feature_394', 'feature_453', 'feature_1079', 'feature_450', 'feature_400', 'feature_1106', 'feature_438', 'feature_1127', 'feature_1207', 'feature_1111', 'feature_1181', 'feature_1042', 'feature_1130', 'feature_443', 'feature_1104', 'feature_448', 'feature_1120', 'feature_1112', 'feature_996', 'feature_422', 'feature_1035', 'feature_397', 'feature_381', 'feature_1101', 'feature_366', 'feature_1100', 'feature_390', 'feature_1055', 'feature_1074', 'feature_1052', 'feature_427', 'feature_509', 'feature_1049', 'feature_1078', 'feature_1068', 'feature_414', 'feature_384', 'feature_1034', 'feature_1081', 'feature_504', 'feature_434', 'feature_411', 'feature_1088', 'feature_426', 'feature_1026', 'feature_389', 'feature_1038', 'feature_1056', 'feature_417', 'feature_1134', 'feature_425', 'feature_1087', 'feature_388', 'feature_380', 'feature_505', 'feature_999', 'feature_1076', 'feature_395', 'feature_386', 'feature_365', 'feature_1083', 'feature_1246', 'feature_1108', 'feature_356', 'feature_1217', 'feature_368', 'feature_1023', 'feature_433', 'feature_416', 'feature_419', 'feature_379', 'feature_1077', 'feature_1109', 'feature_393', 'feature_1080', 'feature_1173', 'feature_1060', 'feature_1050', 'feature_1067', 'feature_1032', 'feature_373', 'feature_375', 'feature_385', 'feature_1092', 'feature_1006', 'feature_1048', 'feature_1039', 'feature_401', 'feature_1027', 'feature_359', 'feature_1029', 'feature_410', 'feature_398', 'feature_1086', 'feature_362', 'feature_392', 'feature_407', 'feature_1065', 'feature_1044', 'feature_383', 'feature_363', 'feature_436', 'feature_367', 'feature_1064', 'feature_1022', 'feature_1025', 'feature_1007', 'feature_378', 'feature_360', 'feature_989', 'feature_1041', 'feature_347', 'feature_358', 'feature_402', 'feature_998', 'feature_1018', 'feature_376', 'feature_336', 'feature_432', 'feature_1033', 'feature_1249', 'feature_1095', 'feature_1037', 'feature_364', 'feature_1059', 'feature_354', 'feature_377', 'feature_1016', 'feature_1011', 'feature_992', 'feature_1045', 'feature_396', 'feature_404', 'feature_357', 'feature_344', 'feature_329', 'feature_428', 'feature_337', 'feature_1072', 'feature_349', 'feature_993', 'feature_326', 'feature_1053', 'feature_424', 'feature_342', 'feature_1024', 'feature_991', 'feature_415', 'feature_399', 'feature_406', 'feature_361', 'feature_1028', 'feature_340', 'feature_332', 'feature_986', 'feature_1036', 'feature_445', 'feature_1021', 'feature_1005', 'feature_1004', 'feature_343', 'feature_348', 'feature_987', 'feature_1123', 'feature_325', 'feature_1085', 'feature_1013', 'feature_331', 'feature_994', 'feature_322', 'feature_1010', 'feature_391', 'feature_1008', 'feature_382', 'feature_312', 'feature_321', 'feature_990', 'feature_324', 'feature_997', 'feature_985', 'feature_328', 'feature_316', 'feature_319', 'feature_318', 'feature_338', 'feature_1066', 'feature_1014', 'feature_1019', 'feature_327', 'feature_1071', 'feature_1090', 'feature_1075', 'feature_353', 'feature_317', 'feature_335', 'feature_1093', 'feature_1058', 'feature_314', 'feature_1040', 'feature_315', 'feature_323', 'feature_1003', 'feature_320', 'feature_600', 'feature_1047', 'feature_330', 'feature_313', 'feature_351', 'feature_1012', 'feature_346', 'feature_1043', 'feature_345', 'feature_1057', 'feature_311', 'feature_1063', 'feature_472', 'feature_933', 'feature_466', 'feature_988', 'feature_1161', 'feature_350', 'feature_355', 'feature_1235', 'feature_374', 'feature_459', 'feature_1248', 'feature_334', 'feature_1102', 'feature_403', 'feature_369', 'feature_1172', 'feature_970', 'feature_1178', 'feature_1002', 'feature_1017', 'feature_1031', 'feature_1250', 'feature_499', 'feature_1091', 'feature_372', 'feature_1167', 'feature_437', 'feature_1020', 'feature_387', 'feature_904', 'feature_341', 'feature_524', 'feature_339', 'feature_440', 'feature_1113', 'feature_649', 'feature_525', 'timestamp', 'user_id', 'product_id', 'is_sold', 'year_month']

После преобразования категориальных признаков:
Размер x_tr: (43378, 500)
Размер x_val: (25083, 500)

=== Отбор фичей ===
Исходное количество фичей: 500
Целевое количество фичей: 200
  Категориальный признак 'feature_521': примеры значений ['-0.74995756', 'MISSING', '1.3335115']
  Категориальный признак 'feature_968': примеры значений ['-0.11674039', '8.566675', 'MISSING']
  Категориальный признак 'feature_1160': примеры значений ['MISSING', '-0.51835585', '4.592122', '9.7026005', '14.813078']
  Категориальный признак 'feature_969': примеры значений ['1.0', '0.0', '2.0', '3.0']
  Категориальный признак 'feature_510': примеры значений ['-0.13155714', 'MISSING', '7.6018457']
  Категориальный признак 'feature_1157': примеры значений ['0.0', '1.0', '2.0']
  Категориальный признак 'feature_545': примеры значений ['-0.61436224', 'MISSING', '1.6278297']
  Категориальный признак 'feature_1096': примеры значений ['-0.15355375', 'MISSING', '6.5128794']
  Категориальный признак 'feature_1229': примеры значений ['-0.16591525', 'MISSING', '6.027638']
  Категориальный признак 'feature_639': примеры значений ['0.0', '1.0']
  Категориальный признак 'feature_635': примеры значений ['-0.18493907', 'MISSING', '5.407603']
  Категориальный признак 'feature_1239': примеры значений ['-0.67220116', 'MISSING', '1.4877645']
  Категориальный признак 'feature_512': примеры значений ['-1.2557987', 'MISSING', '0.79636735']
  Категориальный признак 'feature_533': примеры значений ['-0.15029167', '6.6542416', 'MISSING']
  Категориальный признак 'feature_1222': примеры значений ['-0.17240487', 'MISSING', '5.800747']
  Категориальный признак 'feature_615': примеры значений ['-0.28776678', 'MISSING', '3.4753036']
  Категориальный признак 'feature_587': примеры значений ['-0.26141608', 'MISSING', '3.8256142']
  Категориальный признак 'feature_591': примеры значений ['-0.060532406', '10.046222', 'MISSING', '20.152975', '30.25973']
  Категориальный признак 'feature_488': примеры значений ['0.0', '1.0']
  Категориальный признак 'feature_1192': примеры значений ['-0.13927527', 'MISSING', '7.1805787']
  Категориальный признак 'feature_1193': примеры значений ['-0.97173154', 'MISSING', '1.02917']
  Категориальный признак 'feature_489': примеры значений ['0.0', '1.0']
  Категориальный признак 'feature_1221': примеры значений ['-0.5451247', 'MISSING', '1.8345839']
  Категориальный признак 'feature_1218': примеры значений ['-0.8689407', '1.12222', '3.113381', 'MISSING', '5.104542']
  Категориальный признак 'feature_1110': примеры значений ['-0.15532121', 'MISSING', '6.4387665']
  Категориальный признак 'feature_571': примеры значений ['-0.16710404', 'MISSING', '5.9847565']
  Категориальный признак 'feature_518': примеры значений ['0.0', '1.0']
  Категориальный признак 'feature_1223': примеры значений ['-0.38906044', 'MISSING', '2.5704927']
  Категориальный признак 'feature_503': примеры значений ['-0.19816695', 'MISSING', '5.046639']
  Категориальный признак 'feature_597': примеры значений ['-1.2845562', 'MISSING', '0.77853894']
  Категориальный признак 'feature_976': примеры значений ['-2.038237', 'MISSING', '0.49065784']
  Категориальный признак 'feature_507': примеры значений ['-0.007896302', 'MISSING']
  Категориальный признак 'feature_500': примеры значений ['-0.21917827', 'MISSING', '4.5628476']
  Категориальный признак 'feature_979': примеры значений ['-0.48868588', 'MISSING', '2.0464618']
  Категориальный признак 'feature_980': примеры значений ['-0.18769144', 'MISSING', '5.328304']
  Категориальный признак 'feature_484': примеры значений ['-0.33854777', 'MISSING', '2.9540205']
  Категориальный признак 'feature_1170': примеры значений ['-0.09532985', 'MISSING', '10.490702']
  Категориальный признак 'feature_1201': примеры значений ['-0.954672', 'MISSING', '1.0475609']
  Категориальный признак 'feature_1220': примеры значений ['-0.6048425', 'MISSING', '1.6534504']
  Категориальный признак 'feature_522': примеры значений ['MISSING', '-0.26579013', '7.363704', '14.993199', '22.622694']
  Категориальный признак 'feature_586': примеры значений ['-0.3606386', 'MISSING', '2.7730727']
  Категориальный признак 'feature_470': примеры значений ['-0.41286108', 'MISSING', '2.4223087']
  Категориальный признак 'feature_590': примеры значений ['-0.7619775', 'MISSING', '1.3124758']
  Категориальный признак 'feature_511': примеры значений ['-0.124149255', 'MISSING', '8.055441']
  Категориальный признак 'feature_1183': примеры значений ['-0.28054726', 'MISSING', '3.5647361']
  Категориальный признак 'feature_1226': примеры значений ['-0.20731792', 'MISSING', '4.823881']
  Категориальный признак 'feature_654': примеры значений ['-0.2982251', 'MISSING', '3.35343']
  Категориальный признак 'feature_1186': примеры значений ['-0.32559857', 'MISSING', '3.0715032']
  Категориальный признак 'feature_478': примеры значений ['-0.5447432', 'MISSING', '1.8358687']
  Категориальный признак 'feature_1097': примеры значений ['-0.50193197', '1.9924552', 'MISSING']
  Категориальный признак 'feature_576': примеры значений ['-0.3477097', 'MISSING', '2.876184']
  Категориальный признак 'feature_479': примеры значений ['-0.21573761', 'MISSING', '4.6356173']
  Категориальный признак 'feature_446': примеры значений ['-1.2591426', 'MISSING', '0.79425234']
  Категориальный признак 'feature_1241': примеры значений ['-0.033199407', 'MISSING']
  Категориальный признак 'feature_471': примеры значений ['-0.11067088', 'MISSING', '9.036496']
  Категориальный признак 'feature_1194': примеры значений ['-0.48822862', 'MISSING', '2.0483785']
  Категориальный признак 'feature_1177': примеры значений ['-0.028692566', '29.700686', 'MISSING', '59.43006']
  Категориальный признак 'feature_541': примеры значений ['0.0', '1.0']
  Категориальный признак 'feature_1054': примеры значений ['-0.6060698', 'MISSING', '1.650102']
  Категориальный признак 'feature_630': примеры значений ['0.0', '1.0']
  Категориальный признак 'feature_457': примеры значений ['-0.10931837', 'MISSING', '9.148297']
  Категориальный признак 'feature_493': примеры значений ['-0.35573357', 'MISSING', '2.811309']
  Категориальный признак 'feature_1184': примеры значений ['-1.5546886', 'MISSING', '0.6432652']
  Категориальный признак 'feature_1030': примеры значений ['-0.18289302', 'MISSING', '5.468098']
  Категориальный признак 'feature_1237': примеры значений ['-0.58919394', 'MISSING', '1.6973647']
  Категориальный признак 'feature_514': примеры значений ['2.0', '0.0', '1.0', '3.0', 'MISSING']
  Категориальный признак 'feature_1180': примеры значений ['-0.8714465', 'MISSING', '1.1476058']
  Категориальный признак 'feature_467': примеры значений ['-0.11713356', 'MISSING', '8.53792']
  Категориальный признак 'feature_520': примеры значений ['-0.58536494', 'MISSING', '1.7084676']
  Категориальный признак 'feature_516': примеры значений ['-0.13431436', 'MISSING', '7.4457936']
  Категориальный признак 'feature_1107': примеры значений ['-0.12984161', 'MISSING', '7.702285']
  Категориальный признак 'feature_1247': примеры значений ['-0.08988734', 'MISSING', '11.125894']
  Категориальный признак 'feature_1145': примеры значений ['1.0', '0.0']
  Категориальный признак 'feature_1147': примеры значений ['-0.20020099', '4.9953647', 'MISSING']
  Категориальный признак 'feature_429': примеры значений ['-0.19816695', 'MISSING', '5.046639']
  Категориальный признак 'feature_1156': примеры значений ['0.0', '2.0', '1.0', '4.0', '3.0']
  Категориальный признак 'feature_454': примеры значений ['-0.6377389', 'MISSING', '1.5681607']
  Категориальный признак 'feature_1148': примеры значений ['-0.13266642', 'MISSING', '7.538283']
  Категориальный признак 'feature_1137': примеры значений ['-0.8371685', 'MISSING', '1.1945946']
  Категориальный признак 'feature_513': примеры значений ['-0.13324636', 'MISSING', '7.5054736']
  Категориальный признак 'feature_1061': примеры значений ['-0.9773491', 'MISSING', '1.0232546']
  Категориальный признак 'feature_477': примеры значений ['MISSING', '-0.19541268', '16.066423', '32.32826', '48.590096']
  Категориальный признак 'feature_1118': примеры значений ['1.1928785', '-0.83837295', 'MISSING']
  Категориальный признак 'feature_486': примеры значений ['-0.12327217', 'MISSING']
  Категориальный признак 'feature_1094': примеры значений ['-0.7708215', 'MISSING', '1.297417']
  Категориальный признак 'feature_423': примеры значений ['0.9193541', '-1.087804', 'MISSING']
  Категориальный признак 'feature_485': примеры значений ['-0.32851574', 'MISSING', '3.0442288']
  Категориальный признак 'feature_451': примеры значений ['-0.7688278', 'MISSING', '1.3007816']
  Категориальный признак 'feature_1155': примеры значений ['-0.12379851', 'MISSING', '8.078263']
  Категориальный признак 'feature_1117': примеры значений ['-0.19227129', '5.201385', 'MISSING']
  Категориальный признак 'feature_1144': примеры значений ['0.31576654', '-1.0142934', '-2.3443532', 'MISSING', '-3.6744132']
  Категориальный признак 'feature_1139': примеры значений ['-0.15133458', 'MISSING', '6.608384']
  Категориальный признак 'feature_409': примеры значений ['-0.1668511', 'MISSING', '5.9938293']
  Категориальный признак 'feature_1133': примеры значений ['0.8266171', '-1.2098432', 'MISSING']
  Категориальный признак 'feature_1126': примеры значений ['-0.23484272', '4.258497', 'MISSING']
  Категориальный признак 'feature_1046': примеры значений ['-0.12289756', 'MISSING', '8.137485']
  Категориальный признак 'feature_1115': примеры значений ['-0.34770703', 'MISSING', '2.876206']
  Категориальный признак 'feature_1073': примеры значений ['-0.1100171', 'MISSING', '9.090197']
  Категориальный признак 'feature_435': примеры значений ['-0.13966879', 'MISSING', '7.160347']
  Категориальный признак 'feature_418': примеры значений ['-0.4553245', 'MISSING', '2.196405']
  Категориальный признак 'feature_1082': примеры значений ['-0.35578853', 'MISSING', '2.810875']
  Категориальный признак 'feature_394': примеры значений ['-0.26151532', 'MISSING', '3.824162']
  Категориальный признак 'feature_1079': примеры значений ['-0.5691796', 'MISSING', '1.7570499']
  Категориальный признак 'feature_400': примеры значений ['-0.1492986', 'MISSING', '6.6985025']
  Категориальный признак 'feature_1106': примеры значений ['MISSING', '-0.19829348', '7.143745', '14.485784', '29.16986']
  Категориальный признак 'feature_1207': примеры значений ['-0.1169178', 'MISSING', '8.553677']
  Категориальный признак 'feature_1111': примеры значений ['0.0', 'MISSING', '1.0', '12.0', '5.0']
  Категориальный признак 'feature_1042': примеры значений ['-0.63675696', 'MISSING', '1.5705788']
  Категориальный признак 'feature_1130': примеры значений ['0.0', '1.0']
  Категориальный признак 'feature_443': примеры значений ['-0.16739137', 'MISSING', '5.9744835']
  Категориальный признак 'feature_448': примеры значений ['-0.44772807', 'MISSING', '2.2336705']
  Категориальный признак 'feature_1112': примеры значений ['-0.047816396', '20.914938', 'MISSING']
  Категориальный признак 'feature_397': примеры значений ['-0.17779371', 'MISSING', '5.624929']
  Категориальный признак 'feature_381': примеры значений ['-1.5573478', 'MISSING', '0.6421668']
  Категориальный признак 'feature_427': примеры значений ['MISSING', '-0.6801813', '4.078277', '8.836736', '13.595194']
  Категориальный признак 'feature_1049': примеры значений ['-0.57304764', 'MISSING', '1.7451899']
  Категориальный признак 'feature_1068': примеры значений ['-0.45741397', 'MISSING', '2.1863718']
  Категориальный признак 'feature_414': примеры значений ['-0.13696718', 'MISSING', '7.3015814']
  Категориальный признак 'feature_1081': примеры значений ['-0.40086022', 'MISSING', '2.4948273']
  Категориальный признак 'feature_434': примеры значений ['-0.3532336', 'MISSING', '2.8312058']
  Категориальный признак 'feature_411': примеры значений ['-0.4731745', 'MISSING', '2.1135478']
  Категориальный признак 'feature_389': примеры значений ['-0.097134985', 'MISSING', '10.295745']
  Категориальный признак 'feature_1056': примеры значений ['-1.9870933', 'MISSING', '0.50328636']
  Категориальный признак 'feature_425': примеры значений ['-0.2256941', 'MISSING', '4.431117']
  Категориальный признак 'feature_380': примеры значений ['-0.4206993', 'MISSING', '2.3771777']
  Категориальный признак 'feature_999': примеры значений ['-0.109616876', 'MISSING', '9.123385']
  Категориальный признак 'feature_1076': примеры значений ['-0.14240612', 'MISSING', '7.0227113']
  Категориальный признак 'feature_386': примеры значений ['-0.911738', 'MISSING', '1.0968908']
  Категориальный признак 'feature_1246': примеры значений ['-0.6071344', 'MISSING', '1.6472086']
  Категориальный признак 'feature_1108': примеры значений ['-0.12875968', 'MISSING', '7.7670045']
  Категориальный признак 'feature_1023': примеры значений ['-0.7834698', '0.19599247', '1.1754547', '2.154917', '-1.7629321']
  Категориальный признак 'feature_433': примеры значений ['-0.5544112', '2.0854745', '0.76553166', '3.4054174', '4.7253604']
  Категориальный признак 'feature_419': примеры значений ['-0.25868815', 'MISSING', '3.8659558']
  Категориальный признак 'feature_393': примеры значений ['-0.31375426', 'MISSING', '3.1874533']
  Категориальный признак 'feature_1173': примеры значений ['5.0', '4.0', '0.0', '2.0', '3.0']
  Категориальный признак 'feature_1060': примеры значений ['-0.14700016', 'MISSING', '6.8032374']
  Категориальный признак 'feature_1050': примеры значений ['0.0', '1.0']
  Категориальный признак 'feature_373': примеры значений ['-0.45360115', 'MISSING', '2.2047498']
  Категориальный признак 'feature_1039': примеры значений ['-0.26962033', 'MISSING', '3.709205']
  Категориальный признак 'feature_359': примеры значений ['-0.081737794', 'MISSING', '12.235185']
  Категориальный признак 'feature_1029': примеры значений ['-2.0166075', 'MISSING', '0.4959205']
  Категориальный признак 'feature_1086': примеры значений ['-0.24899025', 'MISSING', '4.016531']
  Категориальный признак 'feature_362': примеры значений ['-1.0662894', 'MISSING', '0.93790394']
  Категориальный признак 'feature_1065': примеры значений ['-1.2613161', 'MISSING', '0.79288375']
  Категориальный признак 'feature_383': примеры значений ['-0.13209274', 'MISSING', '7.5710216']
  Категориальный признак 'feature_363': примеры значений ['-0.36944738', 'MISSING', '2.7069538']
  Категориальный признак 'feature_1064': примеры значений ['-0.3874381', 'MISSING', '2.5812564']
  Категориальный признак 'feature_1025': примеры значений ['-0.22357184', 'MISSING', '4.47318']
  Категориальный признак 'feature_1007': примеры значений ['-0.3218387', 'MISSING', '3.1073859']
  Категориальный признак 'feature_378': примеры значений ['0.0', '1.0']
  Категориальный признак 'feature_989': примеры значений ['-0.15703386', 'MISSING', '6.3685436']
  Категориальный признак 'feature_347': примеры значений ['-0.3656574', 'MISSING', '2.735011']
  Категориальный признак 'feature_358': примеры значений ['-0.12483281', 'MISSING', '8.011332']
  Категориальный признак 'feature_402': примеры значений ['-0.4459196', 'MISSING', '2.2427294']
  Категориальный признак 'feature_1033': примеры значений ['-0.7428289', 'MISSING', '1.3463087']
  Категориальный признак 'feature_1059': примеры значений ['-0.13273224', 'MISSING', '7.5345445']
  Категориальный признак 'feature_354': примеры значений ['-0.15816793', 'MISSING', '6.322881']
  Категориальный признак 'feature_1011': примеры значений ['-0.13527617', 'MISSING', '7.392854']
  Категориальный признак 'feature_404': примеры значений ['-0.096459456', 'MISSING']
  Категориальный признак 'feature_344': примеры значений ['-0.64932', 'MISSING', '1.5401913']
  Категориальный признак 'feature_329': примеры значений ['-0.18268304', 'MISSING', '5.4743834']
  Категориальный признак 'feature_337': примеры значений ['-0.10992144', 'MISSING', '9.098106']
  Категориальный признак 'feature_993': примеры значений ['-0.14617522', 'MISSING', '6.841632']
  Категориальный признак 'feature_326': примеры значений ['-0.18362421', 'MISSING', '5.446325']
  Категориальный признак 'feature_340': примеры значений ['-0.112690695', 'MISSING', '8.874531']
  Категориальный признак 'feature_986': примеры значений ['-0.14617522', 'MISSING', '6.841632']
  Категориальный признак 'feature_1004': примеры значений ['-0.23086922', 'MISSING', '4.3317904']
  Категориальный признак 'feature_1013': примеры значений ['-0.24521577', 'MISSING', '4.836484', '3.71851', '4.074229']
  Категориальный признак 'feature_331': примеры значений ['-0.023741258', 'MISSING', '42.12401']
  Категориальный признак 'feature_382': примеры значений ['-0.701736', '0.46666312', '1.6350622', '-1.8701351', '3.9718604']
  Категориальный признак 'feature_312': примеры значений ['-0.3790183', 'MISSING', '2.6385982']
  Категориальный признак 'feature_321': примеры значений ['-0.0780319', 'MISSING', '12.816259']
  Категориальный признак 'feature_990': примеры значений ['-0.3939855', 'MISSING', '2.5383599']
  Категориальный признак 'feature_985': примеры значений ['-0.29846856', 'MISSING', '3.3506947']
  Категориальный признак 'feature_1090': примеры значений ['-0.19381864', 'MISSING', '5.1598597']
  Категориальный признак 'feature_335': примеры значений ['-0.15565027', 'MISSING', '6.425154']
  Категориальный признак 'feature_315': примеры значений ['-0.15356375', 'MISSING', '6.5124545']
  Категориальный признак 'feature_1002': примеры значений ['0.0', '1.0']
  Категориальный признак 'feature_499': примеры значений ['0.0', '1.0']
  Категориальный признак 'feature_904': примеры значений ['-0.23749112', 'MISSING', '4.211008']
Выбрано фичей: 200
Топ-20 самых важных фичей:
  feature_525: 26.4601
  feature_649: 2.9894
  feature_499: 2.8299
  feature_904: 2.6461
  feature_339: 1.7743
  feature_1113: 1.7186
  feature_440: 1.4207
  feature_970: 1.3893
  feature_463: 1.3296
  feature_506: 1.1730
  feature_1020: 1.1409
  feature_387: 1.1246
  feature_582: 1.1084
  feature_465: 1.0622
  feature_1178: 1.0120
  feature_372: 0.9515
  feature_524: 0.9370
  feature_607: 0.9219
  feature_1250: 0.8718
  feature_403: 0.8658
Важность фичей сохранена в: C:\IMPORTANT\ACTIVITIES\sirius\repo\personalized-offers\experiments\models\catboost\..\repo\personalized-offers\artifacts\prod_4\catboost\feature_importance_initial.csv

Итоговые размеры данных:
Размер x_tr: (43378, 200)
Размер x_val: (25083, 200)
Размер x_train: (68461, 200)
Размер x_oot: (16923, 200)
Категориальные фичи (20): ['feature_591', 'feature_1193', 'feature_500', 'feature_470', 'feature_541', 'feature_630', 'feature_1156', 'feature_418', 'feature_1082', 'feature_1207']...
Индексы категориальных фичей: [182, 115, 119, 92, 149, 122, 101, 83, 159, 169]...
Лучший ROC-AUC: 0.7467
Лучшие параметры CatBoost:
  iterations: 1545
  learning_rate: 0.022454505554938328
  depth: 5
  l2_leaf_reg: 2.7324455977881374
  random_strength: 5.11496833967874
  bagging_temperature: 0.2003089595070946
  border_count: 212
  early_stopping_rounds: 83
  use_rsm: True
  rsm: 0.16140489365703603
  use_grow_policy: False
Модель обучена. Количество итераций: 1102
Лучшая итерация: 1101
Лучший AUC: 0.7947
{
  "roc_auc": 0.7947440093581075,
  "pr_auc": 0.17602037105805052,
  "precision@k": {
    "1": 1.0,
    "3": 0.26627218934911245,
    "5": 0.23286052009456265,
    "10": 0.1702127659574468
  },
  "recall@k": {
    "1": 0.0015128593040847202,
    "3": 0.2042360060514372,
    "5": 0.2980332829046899,
    "10": 0.4357034795763994,
    "20": 0.6172465960665658
  }
}

Дополнительная информация CatBoost:
Размер OOT выборки: 16923
Количество положительных классов в OOT: 661
Количество деревьев: 1102

Топ-10 важных признаков:
  feature_525: 20.4426
  feature_649: 2.9493
  feature_437: 1.6297
  feature_600: 1.6230
  feature_466: 1.4924
  feature_499: 1.4908
  feature_1102: 1.4224
  feature_1020: 1.3753
  feature_440: 1.3676
  feature_904: 1.3471
